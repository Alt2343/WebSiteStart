{% extends 'base.html' %}
{% load static %}


{% block content %}
<!-- Main Content -->
    <main style="margin-top: 80px; min-height: calc(100vh - 200px); padding: 2rem 0;">
        <div style="max-width: 1000px; margin: 0 auto; padding: 0 20px;">
            <!-- Cart Header -->
            <div style="text-align: center; margin-bottom: 2rem;">
                <h1 style="color: #2c3e50; font-size: 2.5rem; margin-bottom: 0.5rem;">üõí –ö–æ—Ä–∑–∏–Ω–∞ –ø–æ–∫—É–ø—Ç–æ–≤</h1>
                <p style="color: #7f8c8d; font-size: 1.1rem;">–¢–æ–≤–∞—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –≤—ã–±—Ä–∞–ª–∏</p>
            </div>
            {% if cart %}
            <!-- Cart with Items -->
            <div>
                <!-- Cart Items List -->
                <div style="background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); overflow: hidden; margin-bottom: 2rem;">
                    {% for item in cart %}
                    {% with product=item.product %}
                    <div style="display: grid; grid-template-columns: 100px 1fr auto auto auto; gap: 1rem; padding: 1.5rem; border-bottom: 1px solid #ecf0f1; align-items: center;">
                        <!-- Product Image -->
                        {% if product.main_image and product.main_image.url %}
                        <img src="{{ product.main_image.url }}"
                             alt="{{ product.name }}"
                             style="width: 100px; height: 100px; object-fit: cover; border-radius: 5px;">
                        {% else %}
                        <div style="color: #999; text-align: center; font-size: 15;">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –≥–æ—Ç–æ–≤–æ</div>
                        {% endif %}
                        <!-- Product Details -->
                        <div>
                            <h3 style="margin-bottom: 0.5rem; color: #2c3e50; font-size: 1.2rem;">{{ product.name }}</h3>
                            <div style="color: #7f8c8d; font-size: 0.9rem;">
                                <div>–ë—Ä–µ–Ω–¥: {{ product.brand }}</div>
                                <div>–¶–µ–Ω–∞ –∑–∞ —à—Ç: {{ product.price }} ‚ÇΩ</div>
                            </div>
                        </div>

                        <!-- Quantity Controls -->
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <!-- –ö–Ω–æ–ø–∫–∞ –º–∏–Ω—É—Å -->
                            <form method="post" action="{% url 'cart:cart_add' product.id %}" style="display: inline;">
                                {% csrf_token %}
                                <input type="hidden" name="quantity" value="{{ item.quantity|add:'-1' }}">
                                <input type="hidden" name="override" value="True">
                                <button type="submit"
                                        style="width: 30px; height: 30px; border: 1px solid #bdc3c7; background: white; border-radius: 3px; cursor: pointer; display: flex; align-items: center; justify-content: center;">-</button>
                            </form>

                            <!-- –¢–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ -->
                            <span style="width: 50px; text-align: center; border: 1px solid #bdc3c7; border-radius: 3px; padding: 5px; background: white;">
                                {{ item.quantity }}
                            </span>

                            <!-- –ö–Ω–æ–ø–∫–∞ –ø–ª—é—Å -->
                            <form method="post" action="{% url 'cart:cart_add' product.id %}" style="display: inline;">
                                {% csrf_token %}
                                <input type="hidden" name="quantity" value="{{ item.quantity|add:'1' }}">
                                <input type="hidden" name="override" value="True">
                                <button type="submit"
                                        style="width: 30px; height: 30px; border: 1px solid #bdc3c7; background: white; border-radius: 3px; cursor: pointer; display: flex; align-items: center; justify-content: center;">+</button>
                            </form>
                        </div>

                        <!-- Total Price -->
                        <div style="font-weight: bold; color: #2c3e50; font-size: 1.1rem;">
                            {{ item.total_price }} ‚ÇΩ
                        </div>

                        <!-- Remove Button -->
                        <form method="post" action="{% url 'cart:cart_remove' product.id %}">
                            {% csrf_token %}
                            <button type="submit"
                                    title="–£–¥–∞–ª–∏—Ç—å"
                                    style="background: none; border: none; color: #e74c3c; cursor: pointer; font-size: 1.2rem; padding: 5px;">üóëÔ∏è</button>
                        </form>
                    </div>
                    {% endwith %}
                    {% endfor %}
                </div>

                <!-- Cart Summary -->
                <div style="background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); padding: 2rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid #ecf0f1;">
                        <span>–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –∏—Ç–æ–≥:</span>
                        <span>{{ cart.get_total_price }} ‚ÇΩ</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid #ecf0f1;">
                        <span>–î–æ—Å—Ç–∞–≤–∫–∞:</span>
                        <span>–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 2rem; padding-bottom: 1rem; border-bottom: 1px solid #ecf0f1; font-size: 1.3rem; font-weight: bold; color: #2c3e50;">
                        <span>–û–±—â–∞—è —Å—É–º–º–∞:</span>
                        <span>{{ cart.get_total_price }} ‚ÇΩ</span>
                    </div>

                    <a href="/order/checkout/"
                       style="display: block; width: 100%; padding: 15px; background: #27ae60; color: white; text-decoration: none; border-radius: 5px; cursor: pointer; font-size: 1.1rem; margin-top: 1rem; text-align: center;">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</a>

                    <div style="text-align: center; margin-top: 2rem;">
                        <a href="/"
                           style="display: inline-block; padding: 12px 30px; background: black; color: white; text-decoration: none; border-radius: 5px;">‚Üê –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏</a>
                    </div>
                </div>
            </div>
            {% else %}
            <!-- Empty Cart -->
            <div style="text-align: center; padding: 3rem; background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                <h2 style="color: #7f8c8d; margin-bottom: 1rem; font-size: 1.8rem;">–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</h2>
                <p style="color: #7f8c8d; margin-bottom: 2rem; font-size: 1.1rem;">–î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –∑–∞–∫–∞–∑</p>
                <a href="/"
                   style="display: inline-block; padding: 12px 30px; background: black; color: white; text-decoration: none; border-radius: 5px;">–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥</a>
            </div>
            {% endif %}
        </div>
    </main>
{% endblock content %}